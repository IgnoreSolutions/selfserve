<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <base href="http://localhost:3000">
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="icon" type="image/png" href="./favicon.ico"/>
    <script src="node_modules/jquery/dist/jquery.js"></script>
    <script src="/scripts/logincheck.js"></script>
    <title>Psych Cat</title>
</head>

<body>
    <header class="jumbotron">
        <div class="container-fluid">
            <div class="row">
                <div class="logo-container align-items-center">
                    <img class="logo-img" src="images/psychcat.png">
                </div>
                <nav class="navbar navbar-expand-md navbar-dark bg-dark w-100" id="navbar">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav mr-auto">
                            <li class="nav-item" id="nav-bio">
                                <a class="nav-link" href="./bio">Bio <span class="sr-only">(current)</span></a>
                            </li>
                            <li class="nav-item" id="nav-blog">
                                <a class="nav-link" href="./blog">Updates</a>
                            </li>
                            <li class="nav-item dropdown" id="nav-gallery">
                                <a class="nav-link dropdown-toggle" id="gallery-text" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="./gallery">Gallery</a>
                                <div class="dropdown-menu psychcat-dropdown" aria-labelledby="gallery-text">
                                    <a class="dropdown-item" id="nav-pastevents" href="./gallery/past">Past Events</a>
                                    <a class="dropdown-item" id="nav-paintings" href="./gallery/paintings">Paintings</a>
                                    <a class="dropdown-item" id="nav-musicians" href="./gallery/musicians">Musicians</a>
                                </div>
                            </li>
                            <li class="nav-item" id="nav-music"><a class="nav-link" href="./music">Music</a></li>
                            <li class="nav-item">
                                <a class="nav-link" href="./shop">Shop</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="contact-us" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Get in Touch
                                </a>
                                <div class="dropdown-menu psychcat-dropdown" aria-labelledby="contact-us">
                                    <a class="dropdown-item" href="https://instagram.com/psych.cat/">Instagram</a>
                                    <a class="dropdown-item" href="https://www.facebook.com/psychcat/">Facebook</a>
                                    <a class="dropdown-item" href="mailto:psychcat666@gmail.com">Email</a>
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <div class="container h-100">
        <div class="row h-100 align-items-center">
            <div id="maincontentarea" class="h-100">
                <script>

function addNewUser()
{
    var _username = prompt("Enter the new user's username.", "undefined");
    var _password = "password";
    var _email = "email@default.com";

    $.post("/TESTING/adduser", {username: _username, password: _password, email: _email}, function(result, status, xhr) {
        console.log(result);
    });
}

function removeUser()
{
    var __id = prompt("Enter the ID you want to delete.", "");
    $.post("/TESTING/removeuser", {_id: __id}, function(result, status, xhr) {
        updateList();
    });
}

function clearList()
{
    $("dt").remove();
    $("dd").remove();
}

function updateList()
{
    clearList();

    $.get("/TESTING/userlist", function(result, status, xhr) {
        var asObj = JSON.parse(result);
        asObj.forEach(element => {
            var _user, _email, _signup, __id;
            _user = $("<dt></dt>").text(element.username);
            _email = $("<dd></dd>").text("- " + element.email);
            _signup = $("<dd></dd>").text("- " + element.signup_date);
            __id = $("<dd></dd>").text("- " + element._id);

            $("#userdb_list").append(_user);
            $("#userdb_list").append(_email);
            $("#userdb_list").append(_signup);
            $("#userdb_list").append(__id);
        });
        
        console.log(result);
    });
}

window.onload = function() {updateList();}

</script>

<div class="col h-100" id="userdb_root" onload="updateList()">
    <h3>User DB Testing</h3>
    <dl id="userdb_list">
    </dl>
    <form>
        <button type="button" onclick="addNewUser()">New User</button>
        <button type="button" onclick="removeUser()">Remove User</button>
        <button type="button" onclick="updateList()">Reload Database</button>
    </form>
</div>
            </div>
            <!--
            <div id="sidenav" class="col-2 d-none d-md-block h-100">
                <h3>Recent Blog Posts</h3>
                <script>
                    $.get( "/blog/getpost?limit=5", function( data ) {
                        var resultingPosts = JSON.parse(data);
                        resultingPosts.posts.sort(function(a, b){
                            return b.date - a.date;
                        });
                        resultingPosts.posts.forEach(element => {
                            var div = $("<div>").attr('id', 'sidenav-post');
                            var sidenav = $("#sidenav");
                            div.html(`<a href="/blog/viewpost?id=${element.id}">${element.title}</a><br>${element.author} - ${element.date}<hr>`);
                            sidenav.append(div);
                        });
                    });
                </script>
            </div>
            -->
        </div>
    </div>
    
    
    <script src="node_modules/popper.js/dist/umd/popper.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
</body>

</html>